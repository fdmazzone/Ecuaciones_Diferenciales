\documentclass{article}
%\documentclass[hyperref={colorlinks=true}]{beamer}
%\documentclass[handout,hyperref={colorlinks=true}]{beamer}


%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%Paquetes%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

%\usepackage{pgfpages}
%\pgfpagesuselayout{4 on 1}[a4paper,landscape,border shrink=5mm]
\usepackage{empheq}
\usepackage[spanish]{babel}
\usepackage[utf8x]{inputenc}
\usepackage{times}
\usepackage[T1]{fontenc}
\usepackage{amssymb,amsmath}
\usepackage{enumerate}
\usepackage{verbatim}
\usepackage{ esint }
\usepackage{pdfsync}
%\usepackage{pst-all}
%\usepackage{pstricks-add}
\usepackage{array}
%\usepackage[T1]{fontenc}
\usepackage{animate}
%\usepackage{media9}
%\usepackage{movie15}
\usepackage{xparse}
\usepackage{listings}
\usepackage{ wasysym }
\usepackage{sagetex}
\usepackage{hyperref}

\usepackage{tabularx}

%%%%%%%%%%%%%%%%%%%%%%%%%Configuracion listing
\lstdefinelanguage{Sage}[]{Python}
{morekeywords={False,sage,True},sensitive=true}
\lstset{
  frame=none,
  showtabs=False,
  showspaces=False,
  showstringspaces=False,
  commentstyle={\ttfamily\color{dgreencolor}},
  keywordstyle={\ttfamily\color{dbluecolor}\bfseries},
  stringstyle={\ttfamily\color{dgraycolor}\bfseries},
  language=Sage,
  basicstyle={\fontsize{8pt}{8pt}\ttfamily},
  aboveskip=.3em,
  belowskip=0.1em,
  numbers=none,
  numberstyle=\footnotesize
}


 


%%%%%%%%%%%%%%%%%%%%%%%%Colores
\definecolor{myblue}{rgb}{.8, .8, 1}
\definecolor{dblackcolor}{rgb}{0.0,0.0,0.0}
\definecolor{dbluecolor}{rgb}{0.01,0.02,0.7}
\definecolor{dgreencolor}{rgb}{0.2,0.4,0.0}
\definecolor{dgraycolor}{rgb}{0.30,0.3,0.30}
\newcommand{\dblue}{\color{dbluecolor}\bf}
\newcommand{\dred}{\color{dredcolor}\bf}
\newcommand{\dblack}{\color{dblackcolor}\bf}



\newtheorem{thm}{Teorema}






%%%%%%%%%%%%%%%%%%%%%%%%%%Nuevos comandos entornos%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\newenvironment{demo}{\noindent\emph{Dem.}}{$\square$ \newline\vspace{5pt}}
\newcommand{\com}{\mathbb{C}}
\newcommand{\dis}{\mathbb{D}}
\newcommand{\rr}{\mathbb{R}}
\newcommand{\oo}{\mathcal{O}}
\renewcommand{\emph}[1]{\textcolor[rgb]{1,0,0}{#1}}
\newcommand{\der}[2]{\frac{\partial #1}{\partial #2}}
\renewcommand{\v}[1]{\overrightarrow{#1}}
\renewcommand{\epsilon}{\varepsilon}
\newlength\mytemplen
\newsavebox\mytempbox
\makeatletter
\newcommand\mybluebox{%
    \@ifnextchar[%]
       {\@mybluebox}%
       {\@mybluebox[0pt]}}

\def\@mybluebox[#1]{%
    \@ifnextchar[%]
       {\@@mybluebox[#1]}%
       {\@@mybluebox[#1][0pt]}}

\def\@@mybluebox[#1][#2]#3{
    \sbox\mytempbox{#3}%
    \mytemplen\ht\mytempbox
    \advance\mytemplen #1\relax
    \ht\mytempbox\mytemplen
    \mytemplen\dp\mytempbox
    \advance\mytemplen #2\relax
    \dp\mytempbox\mytemplen
    \colorbox{myblue}{\hspace{1em}\usebox{\mytempbox}\hspace{1em}}}

\makeatother
\DeclareDocumentCommand\boxedeq{ m g }{%
    {\begin{empheq}[box={\mybluebox[2pt][2pt]}]{equation}% #1%
        \IfNoValueF {#2} {\label{#2}}%
       #1
       \end{empheq}
    }%
}
\DeclareMathOperator{\mcd}{mcd}
\DeclareMathOperator{\atan2}{atan2}
\DeclareMathOperator{\sen}{sen}
\newtheorem{teorema}{Teorema}[section]
\newtheorem{lema}[teorema]{Lema}
\newtheorem{corolario}[teorema]{Corolario}
\newtheorem{proposicion}[teorema]{Proposici\'on}
\newtheorem{definicion}[teorema]{Definici\'on}
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%




%%%%%%%%%%Para escibir en clase articulo o similar
\usepackage{color}
\newcommand{\nl}{ }
\renewenvironment{frame}[1]{}{}
\newcommand{\qed}{$\square$}
%\newcommand{\defverbatim}{\def{#1}}
\newenvironment{block}[1]{\textbf{#1}}{}
\title{Ecuaciones lineales de segundo orden}
\author{Fernando Mazzone}





%%%%%%%%%%%%%%%%%%%%%%%Para clase beamer
% \newcommand{\nl}{\onslide<+-> }
% % \mode<all>
% % {
% %   \usetheme{Boadilla}
% %   % oder ...
% %  
% %   \setbeamercovered{wolverine}
% %   % oder auch nicht
% % }
% 
% 
% \mode<handout>{
%   \usetheme{default}
%   %\setbeamercolor{background canvas}{bg=black!5}
%  % \pgfpagesuselayout{2 on 1}[a4paper,landscape,border shrink=2.5mm]
% }
% 
% % \mode<all>{
% %   \usetheme{default}
% %   %\setbeamercolor{background canvas}{bg=black!5}
% %   \pgfpagesuselayout{4 on 1}[letterpaper,landscape,border shrink=2.5mm]
% % }
% 
% \title[Ecuaciones lineales de segundo orden] % (optional, nur bei langen Titeln nötig)
% {%
%  Ecuaciones lineales de segundo orden
% }
% 
% 
% 
% \author[] % (optional, nur bei vielen Autoren)
% {Fernando Mazzone}
% 
% \institute[Depto de Matemática] % (optional, aber oft nötig)
% {
%  Depto de Matemática\\
% Facultad de Ciencias Exactas Físico-Químicas y Naturales\\
% Universidad Nacional de Río Cuarto}
% 
% 
% \subject{Ecuaciones Diferenciales}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%




\begin{document}

\section{Teorema de separaciòn de Sturn}

El objetivo  de esta unidad es mostrar como se pueden estudiar propiedades de las soluciones sin resolver la ecuación diferencial. En particular estudiaremos propiedades de  los ceros de las soluciones.

\begin{teorema}[Separación de Sturn] Sean $y_1$ e $y_2$ soluciones linealmente independientes de 
\boxedeq{y''+P(x)y'+Q(x)y=0.}{eq:2_orden_hom}
Entonces entre dos ceros consecutivos de $y_2$ hay exactamente un cero de $y_1$. \end{teorema}
\textbf{Dem.} Sean $x_1$ y $x_2$ ceros sucesivos de $y_2$. Podemos suponer $y_2>0$ en $(x_1,x_2)$. Vamos a considerar el Wronskiano de las soluciones
\[W=y_1(x)y_2'(x)-y_2(x)y_1'(x),\]
que es no nulo por la independencia lineal y por lo tanto tiene siempre el  mismo signo. En los puntos $x_1$ y $x_2$ tenemos $W=y_1(x)y_2'(x)$. Notar que
\[y_2'(x_1)=\lim_{h\to 0+}\frac{y_2(x_1+h)}{h}\geq 0.\]
De  manera similar deducimos $y_2'(x_2)\leq 0$. Por la invariancia del signo de $W=y_1y_2'$ debe ocurrir que $y_1(x_1)$ e $y_1(x_2)$ tiene signos diferentes. Y por lo tanto $y_1$ se debe anular en $(x_1,x_2)$

\begin{teorema} Existe una función $v$ tal que el cambio de variables $y(x)=v(x)u(x)$ transforma la ecuación \eqref{eq:2_orden_hom} en la ecuación
\boxedeq{u''+q(x)u=0.}{eq:2_orden_hom_can}
\end{teorema}
\textbf{Dem.} 
\begin{sageblock}
x=var('x')
y=function('y',x)
u=function('u',x)
v=function('v',x)
P=function('P',x)

Q=function('Q',x)
y=u*v
eq=y.diff(2)+P*y.diff()+Q*y
eq1=eq.coefficient(u.diff())==0
v=desolve(eq1,v)
\end{sageblock}
Obtenemos que $v(x)=\sage{v}$ resuelve nuestro problema.

Hallemos $q$.

\begin{sageblock}
y=u*v
eq=y.diff(x,2)+P*y.diff(x)+Q*y
eq=(eq/v).simplify_full()
\end{sageblock}
Obtenemos
\[\boxed{\sage{eq}=0}.\]
y por lo tanto
\[\boxed{q=\sage{eq.coefficient(u)}}.\]
\qed


\end{document}

